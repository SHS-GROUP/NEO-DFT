 -----------------------------------------
  A PRIORI PROCEDURE FOR SELECTING
  THE CONFIGURATIONAL LIVEWOOD 
  TO GENERATE A COMPACT WAVE-FUNC.
  FOR GAMESS RUN USING GCI CODE 
 -----------------------------------------
 PROGRAM gciselCI.f WRITTEN BY
 LAIMIS BYTAUTAS AND KLAUS RUEDENBERG
  
 REFERENCE:
 (1) L. BYTAUTAS, K. RUEDENBERG, 
     CHEM. PHYS. 356, p.64 (2009).
 -----------------------------------------
 no active MOs:             NTOT=  18
 no doubly occ. MOs in ref: NOCC=  9
 symmetry group is              =  3
 irrep of the group is          =  1
 -----------------------------------------
 irrep symmetries of active MOs
 1 6 1 6 1 8 7 3 4 7 8 4 3 6 1 6 1 6
 Point group symmetry 3
 total irrep symmetry 1
 MAXIMUM # of x=3 SP   NKEEP3= 25000
 MAXIMUM # of x=4 SP   NKEEP4= 25000
 MAXIMUM # of x=5 SP   NKEEP5= 35000
 MAXIMUM # of x=6 SP   NKEEP6= 35000
 -
 Norm3 Fraction x=3 to include = 0.999999999999000022
 Norm3 Fraction: omitted x=3   = 0.999977878279878496E-12
 -
 ISEL2 = TOTAL # of double SPACE-PRODUCTS
 x=4 START CYCLE at (ISEL2*3) /  3
 x=5 START CYCLE at  (ISEL2)  /  4
 x=6 START CYCLE at  (ISEL2)  /  5
 -
 4-uple fraction selected = 0.949999999999999956
 4-uple convergence       = 0.900000000000000022
 4-uple MAXIMUM no cycles = 17
 4-uple CYCLE STEPSIZE    = 20
 -
 5-uple fraction selected = 0.949999999999999956
 5-uple convergence       = 0.800000000000000044
 5-uple MAXIMUM no cycles = 12
 5-uple CYCLE STEPSIZE    = 20
 -
 6-uple fraction selected = 0.949999999999999956
 6-uple convergence       = 0.750000000000000000
 6-uple MAXIMUM no cycles = 12
 6-uple CYCLE STEPSIZE    = 15
 -
 ---------------------------------------
 THE CONVENTION:  (yes=1, no=0)
 IS THIS PRELIMINARY CI-SDT RUN? 0
 Are x=4 excitations included?   1
 Are x=5 excitations included?   1
 Are x=6 excitations included?   1
 ---------------------------------------
 ktab array
 1 2 3 4 5 6 7 8
 Compute total # of SP=LIMITAS 
  single-excitation SP count:  81
  double-excitation SP count:  2025
  triple-excitation SP count:  24336
  quadruple-excitation SP count:  171396
  5-tuple-excitation SP count:  777924
  6-tuple-excitation SP count:  2414916
 -
 TOTAL SP COUNT = 3390679
 WARNING: LIMITAS sould be  <  mxstring= 2000000
 *
 (Q-,5-,6-) mxsprod = 2400000
 (S-,D-,T-) mxsprod1= 100000
 -
 PROBLEM with 6-tuple SP limit
 TOTAL # of 6-tuple SP is 2414916
 THE PRESENT dimension is 2400000
 THUS SET LIMITAS6 = mxsprod 
 Problem with SP total dimension
 THE TOTAL    # of SPs is 3390679
 THE PRESENT dimension is 2000000
 WILL SET LIMITAS = mxstring 
 NORB  = 18
 NTOT  = 18
 NOCC  = 9
 NVIRT = 9
 # alfa electrons NA= 9
 # beta electrons NB= 9
 SDT-CI-vector follows:
 SDT-CI: NSTATEsd, NGCIsd
 No of states, No of determinants
 1 30170
 # of double-SPs= 2025
 # of triple-SPs= 24336
 MAXIMUM # of determinants in SDT-CI: 30170
 ------------------------------------------
 SUMMARY OF EXCITATIONS IN TERMS OF DETS:
 ------------------------------------------
 ISINGLE= 32
 IDOUBLE= 1353
 ITRIPLE= 28784
 IEXTRA= 0
 SUM OF (c**2) in SDT-CI:  1.00000000000001332
 END of SDT-CI cycle
 ------------------------------------------
 *
 NUMBER OF SELECTED DOUBLE SPACE-PRODs= 341
 TOTAL SUM of DOUBLE-SP c**2 = 0.113321518597678236
 *
 new starting DOUBLES-values:
 FOR QUADRUPLES: MAX4IM2 = 341
 FOR QUINTUPLES: MAX5IM2 = 85
 FOR SEXTUPLES:  MAX6SP2 = 68
 OPEN-ENDED CYCLE for excitations x=4,5,6
 4-uple open-ended cycle
              starts at Double-SP = 341
 -
 5-uple open-ended cycle 
              starts at Double-SP = 85
 -
 6-uple open-ended cycle 
              starts at Double-SP = 68
 Triple non-zero sp-prod ISEL3= 3435
 TOTAL triple c**2 sum = 0.117093979563700026E-02
 NOTE: NKEEP3=ISEL3
 deficiency estimate for T 
 -----------------------------------------------
                             ISEL3 = 3435
                            NKEEP3 = 3435
 TOTAL Triple-deficiency  CI3def   = 0.865922089460905962E-18
 RELATIVE Triple-deficiency RELDEF3= 0.739510342621703880E-15
 -----------------------------------------------
 T-selection based on norm3
 -----------------------------------------
 NORM3 FRACTION OF EXCLUDED SP3 = 0.000000000000000000E+00
                          ICUT3 = 3435
 -----------------------------------------
 3-ple: Finally: out of  ISEL3 = 3435
 3-ple: keep            NKEEP3 = 3435
 ---------------------------------------------
 Triples will have         SP3 =  3435
 ---------------------------------------------
 3-norm                CI3norm = 0.117093979563700026E-02
 RELATIVE 3-norm      REL3norm = 1.00000000000000000
 ---------------------------------------------
 3-deficiency        CI3def    = 0.865922089460905962E-18
 RELATIVE 3-deficiency RELDEF3 = 0.739510342621703880E-15
 ---------------------------------------------
 S,D,T space products done from SDT-CI
 ---------------------------------------------
 single excitations start here
 SINGLE-EX. SPs symmetry-unconstrained 82
 SINGLE-EX. SPs symmetry-constrained 17
 DIAGONAL-double excitations start here
 S[1] and D[0] ICOUNT= 487
 mixed double excitations start here
 DOUBLE-EXC. SPs symm-unconstrained: 2107
 DOUBLE-EXC. SPs symm-constrained: 358
 triple excitations start here
 T-case: [1,0]
 T-case: [1,1,1]
 ------------------------------------------------
 T-t:                           NKEEP3 = 3435
 T-t:                           ICOUNT = 26443
 T-t:                          ICOUNT3 = 24336
 T-t: symmetry-reduced strings ICOUNTS = 3793
 CI-SDT done
 ------------------------------------------------
 *
 quadruple excitations start here
 *
 ---
 maximum components SP4 = 75000
         4-tuple SMALL4 = 0.499999999999999990E-12
 ---
 ---
 4-tuple selection: lines-angle
 ISTEP3 = 1
  STEP3 = 1.00000000000000000
 ---
 -------------------------------------------
 THE QUADRUPLE SP "LIVE-WOOD" SELECTION PROCEDURE:
 THE CONVERGENCE CRITERION IS 
 NORM(i)/NORM(i+1) = 0.900000000000000022
 OUT OF THE MOST IMPORTANT QUADRUPLE SP
 ONLY THIS FRACTION WILL BE INCLUDED = 0.949999999999999956
 -------------------------------------------
 *
 *
 *
                    ********************************
                            ICYC4 = 1
                    ********************************
 Q-LIVEWOOD EST. begins at Double-SP = 341.000000000000000
 -------------------------------------------
                            ICYC4 = 1
    Total (D*D) products   ITOT4  = 58311
 Number of SP4 components  INUMB4 = 45127
 Number of distinct SP4     ISEL4 = 15119
                           NKEEP4 = 25000
 -------------------------------------------
                       PUT NKEEP4 = ISEL4
                           NKEEP4 = 15119
 NEW ordered set for 4-tuples:
                            ----------
                            CRITERION-1
                            ----------
                            ICYC4 = 1
 out of selected            ISEL4 = 15119
 will be kept only         NKEEP4 = 7106
                            ICUT4 = 7106
 Norm-4 ratio   is         RATIO4 = 0.950029623651989064
 Norm-4 target  is         TNORM4 = 0.949999999999999956
 Total 4-norm             CI4norm = 0.957497224778061998E-02
 Total 4-deficiency      CI4def   = 0.503631628773911345E-03
 Relative 4-deficency    RELDEF4  = 0.499703763480067037E-01
                            ----------
                            CRITERION-2
                            ----------
                            ICYC4 = 1
 Total 4-norm (new)     CI4newTOT = 0.100786038765545739E-01
 Total 4-norm (old)     CI4oldTOT = 0.000000000000000000E+00
 The ratio of these    RAT4oldnew = 0.000000000000000000E+00
 The target is          OKNORM4   = 0.900000000000000022
 *
 *
 *
                    ********************************
                            ICYC4 = 2
                    ********************************
 ---
 MAX4IM2 = 361
 NOTE: 4-tuple: MAX4IM2 Exceeded ISEL2= 341
 ---
 Q-LIVEWOOD EST. begins at Double-SP = 361.000000000000000
 -------------------------------------------
                            ICYC4 = 2
    Total (D*D) products   ITOT4  = 64921
 Number of SP4 components  INUMB4 = 50408
 Number of distinct SP4     ISEL4 = 16331
                           NKEEP4 = 25000
 -------------------------------------------
                       PUT NKEEP4 = ISEL4
                           NKEEP4 = 16331
 NEW ordered set for 4-tuples:
                            ----------
                            CRITERION-1
                            ----------
                            ICYC4 = 2
 out of selected            ISEL4 = 16331
 will be kept only         NKEEP4 = 7265
                            ICUT4 = 7265
 Norm-4 ratio   is         RATIO4 = 0.950006208212140768
 Norm-4 target  is         TNORM4 = 0.949999999999999956
 Total 4-norm             CI4norm = 0.960929285340446186E-02
 Total 4-deficiency      CI4def   = 0.505686154457572258E-03
 Relative 4-deficency    RELDEF4  = 0.499937917878541110E-01
                            ----------
                            CRITERION-2
                            ----------
                            ICYC4 = 2
 Total 4-norm (new)     CI4newTOT = 0.101149790078620856E-01
 Total 4-norm (old)     CI4oldTOT = 0.100786038765545739E-01
 The ratio of these    RAT4oldnew = 0.996403835215155853
 The target is          OKNORM4   = 0.900000000000000022
 Q-uples: CRITERION2 is satisfied
 Q-uples: (i)/(i+1) ratio is greater than OKNORM4
 -------------------------------------
 For SP4 will keep    NKEEP4 = 7265
 out of total          ISEL4 = 16331
 4-uples: for NKEEP4 TNORMAL = 0.960929285340446186E-02
 at 4-uples: ALLNORMAL(4,5,6)= 0.101149790078620856E-01
 -------------------------------------
 SELECTION OF QUADRUPLE LIVE-WOOD BEGINS
 WILL INCLUDE MOST IMPORTANT SP4= 7265
 Q-selection is step = 2
 At SDT-CI level there are:
 Symmetry-reduced strings = 3793
 Q-case: OCCU=[0,0]
 Q-case: OCCU=[0,1,1]
 Q-case: OCCU=[1,1,1,1]
 -------------------------------------
 THE QUADRUPLE SP LIVE-WOOD SELECTION COMPLETED
 CI-SDTQ only
 # Q-sp NQUADRO= 16331
 # Q-sp ISEL4= 16331
 Selection is complete for NKEEP4= 7265
 Symmetry reduced strings ICOUNTS = 11058
 -------------------------------------
 *
 *
 5-tuple: quintuple excitations start here
 *
 ---
 maximum comp. SP5 MAXSP5 = 105000
 5-tuple SMALL5 = 0.200000000000000006E-12
 -------------------------------------------------
 CONVERGENCE CRITERIUM: internal   TNORM5 = 0.949999999999999956
 CONVERGENCE CRITERIUM: external  OKNORM5 = 0.800000000000000044
 -------------------------------------------------
 ---
 5-tuple selection: lines-angle
 THE ANGLE for (D*T) triangle
 SCREENING STARTS FROM: D(2)*T(1)
 TO: D(1)*T(ISTEP3+1)
 NOTE FOR 5-tuples ISTEP3 is fixed
 HERE IS USED: ISTEP3(FIXED) = 6
  STEP3 = 6.00000000000000000
  SUGGESTED ANGLE (ITfinal) = 2
 ---
 *
 *
 *
                    ********************************
                            ICYC5 = 1
                    ********************************
 5-tuple estimation starts at doubles(SP) = 85
 --------------------------------------------------
                                ICYC5 = 1
          Total (D*T) products  ITOT5 = 21930
                SP5 components INUMB5 = 12272
               Distinct SP5 are ISEL5 = 7960
                               NKEEP5 = 35000
 --------------------------------------------------
                         NOTE: ISEL5 < NKEEP5
                              NKEEP5 = 7960
                            ------------
                            CRITERION-1
                            ------------
                            ICYC5 = 1
                    out of  ISEL5 = 7960
                            ICUT5 = 5691
              will keep    NKEEP5 = 5691
      5-norm for NKEEP5   CI5norm = 0.400869711368182147E-04
        5-relative norm    RATIO5 = 0.950027234748879734
        5-relative target  TNORM5 = 0.949999999999999956
          5-deficiency     CI5def = 0.210863091601583310E-05
 RELATIVE 5-deficiency  RELDEF5 = 0.499727652511169906E-01
                            ------------
                            CRITERION-2
                            ------------
                            ICYC5 = 1
 total 5-norm (new)     CI5newTOT = 0.421956020528341868E-04
 total 5-norm (old)     CI5oldTOT = 0.000000000000000000E+00
 The ratio of old/new             = 0.000000000000000000E+00
 The target is                    = 0.800000000000000044
 *
 *
 *
                    ********************************
                            ICYC5 = 2
                    ********************************
 5-tuple estimation starts at doubles(SP) = 105
 --------------------------------------------------
                                ICYC5 = 2
          Total (D*T) products  ITOT5 = 33390
                SP5 components INUMB5 = 19209
               Distinct SP5 are ISEL5 = 11820
                               NKEEP5 = 35000
 --------------------------------------------------
                         NOTE: ISEL5 < NKEEP5
                              NKEEP5 = 11820
                            ------------
                            CRITERION-1
                            ------------
                            ICYC5 = 2
                    out of  ISEL5 = 11820
                            ICUT5 = 7791
              will keep    NKEEP5 = 7791
      5-norm for NKEEP5   CI5norm = 0.469553623157888215E-04
        5-relative norm    RATIO5 = 0.950018676874473611
        5-relative target  TNORM5 = 0.949999999999999956
          5-deficiency     CI5def = 0.247036315549361349E-05
 RELATIVE 5-deficiency  RELDEF5 = 0.499813231255239604E-01
                            ------------
                            CRITERION-2
                            ------------
                            ICYC5 = 2
 total 5-norm (new)     CI5newTOT = 0.494257254712825574E-04
 total 5-norm (old)     CI5oldTOT = 0.421956020528341868E-04
 The ratio of old/new             = 0.853717404256428503
 The target is                    = 0.800000000000000044
 CRITERION-1: keep only THESE SP5 = 7791
 CRITERION-2: treshold between last triangles OK
 5-: for NKEEP5    TNORMAL(4,5,6) = 0.965624821572024991E-02
 at 5: for ISEL5  ALLNORMAL(4,5,6)= 0.101644047333333681E-01
     
 ---------------------------------------------- 
 FINAL STEP for 5-TUPLES: Start the selection 
    INCLUDING ONLY THESE SP5 = 7791
 5-configuration selection is STEP =  2
       At SDTQ-CI level there are:
 Symmetry-reduced strings ICOUNTS = 11058
 --------------------------
 Quintuple: OCCU=[1,0,0] starts 
  Quintuple OCCU=[1,0,0] done
       5-t: total count ICOUNT5 = 222264
      total string count ICOUNT = 420103
  symmetry reduced string count = 14050
 --------------------------------------------
 Quintuple OCCU=[1,1,1,0] starts
 Quintuple OCCU=[1,1,1,0] done
         5-t: total count ICOUNT5 = 666792
               total string count = 864631
    symmetry reduced string count = 18082
 ----------------------------------------------
 Quintuple OCCU=[1,1,1,1,1] starts
 Quintuple OCCU=[1,1,1,1,1] done
 Quintuple 5-excitations done
        5-t: total count ICOUNT5 = 777924
              total string count = 975763
   symmetry reduced string count = 18849
                    SDTQ5-CI done
 ------------------------------------------------
 -
 6-excitations: 
 -
 -
         maximum SP6-components = 105000
                 6-tuple SMALL6 = 0.499999999999999990E-12
 -
 ----------------------------------------------
 CRITERION-1:        TNORM6 = 0.949999999999999956
 CRITERION-2:       OKNORM6 = 0.750000000000000000
 ----------------------------------------------
               6-tuple selection starts here
 *
 *
 *
                           ***************
                           ICYC6 = 1
                           ***************
 6-t: estimation starts at Doubles = 68
 -------------------------------------------------
 6-tuple selection completed
          Total (D*D*D) products  ITOT6 = 9726
  number of SP6 components       INUMB6 = 2759
         Distinct SP6             ISEL6 = 1765
                                 NKEEP6 = 35000
 -------------------------------------------------
    NOTE ISEL6 < NKEEP6: WILL SET NKEEP6=ISEL6
                                 NKEEP6 = 1765
 NEW ordered set for 6-tuples:
                        ----------------
                          CRITERION-1
                        ----------------
                          ICYC6 =  1
  Number of SP6:          ISEL6 = 1765
                          ICUT6 = 1125
  will keep              NKEEP6 = 1125
 The ratio (internal)    RATIO6 = 0.950458533121860460
 The target is           TNORM6 = 0.949999999999999956
 total 6-norm in NKEEP6 CI6norm = 0.114390260531610155E-03
 6-deficiency            CI6def = 0.596244981324376511E-05
 RELATIVE 6-deficiency  RELDEF6 = 0.495414668781383391E-01
                        ----------------
                          CRITERION-2
                        ----------------
                          ICYC6 =  1
 Actual ratio old/new           = 0.000000000000000000E+00
 The target  is                 = 0.750000000000000000
 Total Norm-6 (new)   CI6newTOT = 0.120352710344854067E-03
 Total Norm-6 (old)   CI6oldTOT = 0.000000000000000000E+00
 *
 *
 *
                           ***************
                           ICYC6 = 2
                           ***************
 6-t: estimation starts at Doubles = 83
 -------------------------------------------------
 6-tuple selection completed
          Total (D*D*D) products  ITOT6 = 17353
  number of SP6 components       INUMB6 = 5209
         Distinct SP6             ISEL6 = 3294
                                 NKEEP6 = 35000
 -------------------------------------------------
    NOTE ISEL6 < NKEEP6: WILL SET NKEEP6=ISEL6
                                 NKEEP6 = 3294
 NEW ordered set for 6-tuples:
                        ----------------
                          CRITERION-1
                        ----------------
                          ICYC6 =  2
  Number of SP6:          ISEL6 = 3294
                          ICUT6 = 2198
  will keep              NKEEP6 = 2198
 The ratio (internal)    RATIO6 = 0.950084988305825107
 The target is           TNORM6 = 0.949999999999999956
 total 6-norm in NKEEP6 CI6norm = 0.150228755571778347E-03
 6-deficiency            CI6def = 0.789263085246498651E-05
 RELATIVE 6-deficiency  RELDEF6 = 0.499150116941731170E-01
                        ----------------
                          CRITERION-2
                        ----------------
                          ICYC6 =  2
 Actual ratio old/new           = 0.761141253985370136
 The target  is                 = 0.750000000000000000
 Total Norm-6 (new)   CI6newTOT = 0.158121386424243623E-03
 Total Norm-6 (old)   CI6oldTOT = 0.120352710344854067E-03
 6-tuples CRITERION-2 is satisfied
 --------------------------------------------
 CRITERION-1: keep only SPs NKEEP6 = 2198
 SELECTED NORM-SUM: TNORMAL(4,5,6) = 0.980647697129202744E-02
 TOTAL NORM-SUM    ALLNORMAL(4,5,6)= 0.103225261197576121E-01
 --------------------------------------------
    RELATIVE-DEFICIENCY(4,5,6)     = 0.499925253255452395E-01
 --------------------------------------------
        At SDTQ5-CI level there are:
 Symmetry-reduced strings ICOUNTS = 18849
 --------------------------------------------
 6-tuple SP selection is STEP = 3
 Sixtuple OCCU=[0,0,0] starts
 Sixtuple OCCU=[0,0,0] done
 Sixtuple OCCU[1,1,0,0] starts
 Sixtuple OCCU[1,1,0,0] done
 Sixtuple OCCU[1,1,1,1,0] starts
 Sixtuple OCCU[1,1,1,1,0] done
 Sixtuple OCCU[1,1,1,1,1,1] starts
 Sixtuple OCCU[1,1,1,1,1,1] done
 -------------------------
 Sixtuple-excitations  done
 CI-SDTQ56 GCI selection  done
 ------------------------------------
  total strings = 3390679
  symmetry reduced strings = 21047
 ------------------------------------
                  FINAL RESULT: 
 --------------------------------------------
 SELECTED NORM-SUM: TNORMAL(4,5,6) = 0.980647697129202744E-02
 TOTAL NORM-SUM:  ALLNORMAL(4,5,6) = 0.103225261197576121E-01
 --------------------------------------------
     RELATIVE-DEFICIENCY(4,5,6)    = 0.499925253255452395E-01
 --------------------------------------------
 *
 *
  *****************************************
  TOTAL SUMMARY (COMPACT CI-SDTQ56) FOR GCI
  *****************************************
 *
 --------------------------------------------
 RELATIVE-DEFICIENCY(4,5,6) = 0.499925253255452395E-01
 --------------------------------------------
 *
 Triples SP3 kept    NKEEP3 = 3435
 out of               ISEL3 = 3435
 *
 Quadruple SP4 kept  NKEEP4 = 7265
 out of               ISEL4 = 16331
 *
 Pentuple SP5 kept   NKEEP5 = 7791
 out of               ISEL5 = 11820
 *
 Sextuple SP6 kept   NKEEP6 = 2198
 out of               ISEL6 = 3294
 --------------------------------------------
 all space-products ICOUNT= 3390679
 symmetry-modified ICOUNTS= 21047
 --------------------------------------------
