 -----------------------------------------
  A PRIORI PROCEDURE FOR SELECTING
  THE CONFIGURATIONAL LIVEWOOD 
  TO GENERATE A COMPACT WAVE-FUNC.
  FOR GAMESS RUN USING GCI CODE 
 -----------------------------------------
 PROGRAM gciselCI.f WRITTEN BY
 LAIMIS BYTAUTAS AND KLAUS RUEDENBERG
  
 REFERENCE:
 (1) L. BYTAUTAS, K. RUEDENBERG, 
     CHEM. PHYS. 356, p.64 (2009).
 -----------------------------------------
 no active MOs:             NTOT=  16
 no doubly occ. MOs in ref: NOCC=  8
 symmetry group is              =  2
 irrep of the group is          =  1
 -----------------------------------------
 irrep symmetries of active MOs
 1 1 1 1 4 3 3 4 4 3 1 1 4 3 1 1
 Point group symmetry 2
 total irrep symmetry 1
 MAXIMUM # of x=3 SP   NKEEP3= 25000
 MAXIMUM # of x=4 SP   NKEEP4= 25000
 MAXIMUM # of x=5 SP   NKEEP5= 35000
 MAXIMUM # of x=6 SP   NKEEP6= 35000
 -
 Norm3 Fraction x=3 to include = 0.999999999999000022
 Norm3 Fraction: omitted x=3   = 0.999977878279878496E-12
 -
 ISEL2 = TOTAL # of double SPACE-PRODUCTS
 x=4 START CYCLE at (ISEL2*3) /  3
 x=5 START CYCLE at  (ISEL2)  /  3
 x=6 START CYCLE at  (ISEL2)  /  3
 -
 4-uple fraction selected = 0.994999999999999996
 4-uple convergence       = 0.998999999999999999
 4-uple MAXIMUM no cycles = 17
 4-uple CYCLE STEPSIZE    = 15
 -
 5-uple fraction selected = 0.949999999999999956
 5-uple convergence       = 0.930000000000000049
 5-uple MAXIMUM no cycles = 12
 5-uple CYCLE STEPSIZE    = 20
 -
 6-uple fraction selected = 0.989999999999999991
 6-uple convergence       = 0.949999999999999956
 6-uple MAXIMUM no cycles = 12
 6-uple CYCLE STEPSIZE    = 17
 -
 ---------------------------------------
 THE CONVENTION:  (yes=1, no=0)
 IS THIS PRELIMINARY CI-SDT RUN? 0
 Are x=4 excitations included?   1
 Are x=5 excitations included?   1
 Are x=6 excitations included?   1
 ---------------------------------------
 ktab array
 1 2 3 4
 Compute total # of SP=LIMITAS 
  single-excitation SP count:  64
  double-excitation SP count:  1296
  triple-excitation SP count:  12544
  quadruple-excitation SP count:  70756
  5-tuple-excitation SP count:  254016
  6-tuple-excitation SP count:  614656
 -
 TOTAL SP COUNT = 953333
 WARNING: LIMITAS sould be  <  mxstring= 2000000
 *
 (Q-,5-,6-) mxsprod = 2400000
 (S-,D-,T-) mxsprod1= 100000
 -
 NORB  = 16
 NTOT  = 16
 NOCC  = 8
 NVIRT = 8
 # alfa electrons NA= 8
 # beta electrons NB= 8
 SDT-CI-vector follows:
 SDT-CI: NSTATEsd, NGCIsd
 No of states, No of determinants
 1 28545
 # of double-SPs= 1296
 # of triple-SPs= 12544
 MAXIMUM # of determinants in SDT-CI: 28545
 ------------------------------------------
 SUMMARY OF EXCITATIONS IN TERMS OF DETS:
 ------------------------------------------
 ISINGLE= 48
 IDOUBLE= 1568
 ITRIPLE= 26928
 IEXTRA= 0
 SUM OF (c**2) in SDT-CI:  1.00000000000000622
 END of SDT-CI cycle
 ------------------------------------------
 *
 NUMBER OF SELECTED DOUBLE SPACE-PRODs= 400
 TOTAL SUM of DOUBLE-SP c**2 = 0.775660680186152501E-01
 *
 new starting DOUBLES-values:
 FOR QUADRUPLES: MAX4IM2 = 400
 FOR QUINTUPLES: MAX5IM2 = 133
 FOR SEXTUPLES:  MAX6SP2 = 133
 OPEN-ENDED CYCLE for excitations x=4,5,6
 4-uple open-ended cycle
              starts at Double-SP = 400
 -
 5-uple open-ended cycle 
              starts at Double-SP = 133
 -
 6-uple open-ended cycle 
              starts at Double-SP = 133
 Triple non-zero sp-prod ISEL3= 3420
 TOTAL triple c**2 sum = 0.127634302266378110E-02
 NOTE: NKEEP3=ISEL3
 deficiency estimate for T 
 -----------------------------------------------
                             ISEL3 = 3420
                            NKEEP3 = 3420
 TOTAL Triple-deficiency  CI3def   = -0.183096340258594941E-17
 RELATIVE Triple-deficiency RELDEF3= -0.143453865463584591E-14
 -----------------------------------------------
 T-selection based on norm3
 -----------------------------------------
 NORM3 FRACTION OF EXCLUDED SP3 = 0.000000000000000000E+00
                          ICUT3 = 3420
 -----------------------------------------
 3-ple: Finally: out of  ISEL3 = 3420
 3-ple: keep            NKEEP3 = 3420
 ---------------------------------------------
 Triples will have         SP3 =  3420
 ---------------------------------------------
 3-norm                CI3norm = 0.127634302266378110E-02
 RELATIVE 3-norm      REL3norm = 1.00000000000000000
 ---------------------------------------------
 3-deficiency        CI3def    = -0.183096340258594941E-17
 RELATIVE 3-deficiency RELDEF3 = -0.143453865463584591E-14
 ---------------------------------------------
 S,D,T space products done from SDT-CI
 ---------------------------------------------
 single excitations start here
 SINGLE-EX. SPs symmetry-unconstrained 65
 SINGLE-EX. SPs symmetry-constrained 25
 DIAGONAL-double excitations start here
 S[1] and D[0] ICOUNT= 353
 mixed double excitations start here
 DOUBLE-EXC. SPs symm-unconstrained: 1361
 DOUBLE-EXC. SPs symm-constrained: 425
 triple excitations start here
 T-case: [1,0]
 T-case: [1,1,1]
 ------------------------------------------------
 T-t:                           NKEEP3 = 3420
 T-t:                           ICOUNT = 13905
 T-t:                          ICOUNT3 = 12544
 T-t: symmetry-reduced strings ICOUNTS = 3845
 CI-SDT done
 ------------------------------------------------
 *
 quadruple excitations start here
 *
 ---
 maximum components SP4 = 75000
         4-tuple SMALL4 = 0.499999999999999990E-12
 ---
 ---
 4-tuple selection: lines-angle
 ISTEP3 = 1
  STEP3 = 1.00000000000000000
 ---
 -------------------------------------------
 THE QUADRUPLE SP "LIVE-WOOD" SELECTION PROCEDURE:
 THE CONVERGENCE CRITERION IS 
 NORM(i)/NORM(i+1) = 0.998999999999999999
 OUT OF THE MOST IMPORTANT QUADRUPLE SP
 ONLY THIS FRACTION WILL BE INCLUDED = 0.994999999999999996
 -------------------------------------------
 *
 *
 *
                    ********************************
                            ICYC4 = 1
                    ********************************
 Q-LIVEWOOD EST. begins at Double-SP = 400.000000000000000
 -------------------------------------------
                            ICYC4 = 1
    Total (D*D) products   ITOT4  = 80200
 Number of SP4 components  INUMB4 = 60748
 Number of distinct SP4     ISEL4 = 14746
                           NKEEP4 = 25000
 -------------------------------------------
                       PUT NKEEP4 = ISEL4
                           NKEEP4 = 14746
 NEW ordered set for 4-tuples:
                            ----------
                            CRITERION-1
                            ----------
                            ICYC4 = 1
 out of selected            ISEL4 = 14746
 will be kept only         NKEEP4 = 6269
                            ICUT4 = 6269
 Norm-4 ratio   is         RATIO4 = 0.995004613723946552
 Norm-4 target  is         TNORM4 = 0.994999999999999996
 Total 4-norm             CI4norm = 0.482258726887143871E-02
 Total 4-deficiency      CI4def   = 0.242116327157600026E-04
 Relative 4-deficency    RELDEF4  = 0.499538627604938050E-02
                            ----------
                            CRITERION-2
                            ----------
                            ICYC4 = 1
 Total 4-norm (new)     CI4newTOT = 0.484679890158721833E-02
 Total 4-norm (old)     CI4oldTOT = 0.000000000000000000E+00
 The ratio of these    RAT4oldnew = 0.000000000000000000E+00
 The target is          OKNORM4   = 0.998999999999999999
 *
 *
 *
                    ********************************
                            ICYC4 = 2
                    ********************************
 ---
 MAX4IM2 = 415
 NOTE: 4-tuple: MAX4IM2 Exceeded ISEL2= 400
 ---
 Q-LIVEWOOD EST. begins at Double-SP = 415.000000000000000
 -------------------------------------------
                            ICYC4 = 2
    Total (D*D) products   ITOT4  = 86080
 Number of SP4 components  INUMB4 = 65292
 Number of distinct SP4     ISEL4 = 15333
                           NKEEP4 = 25000
 -------------------------------------------
                       PUT NKEEP4 = ISEL4
                           NKEEP4 = 15333
 NEW ordered set for 4-tuples:
                            ----------
                            CRITERION-1
                            ----------
                            ICYC4 = 2
 out of selected            ISEL4 = 15333
 will be kept only         NKEEP4 = 6283
                            ICUT4 = 6283
 Norm-4 ratio   is         RATIO4 = 0.995004004953541910
 Norm-4 target  is         TNORM4 = 0.994999999999999996
 Total 4-norm             CI4norm = 0.482283064280370887E-02
 Total 4-deficiency      CI4def   = 0.242158201186862032E-04
 Relative 4-deficency    RELDEF4  = 0.499599504645263908E-02
                            ----------
                            CRITERION-2
                            ----------
                            ICYC4 = 2
 Total 4-norm (new)     CI4newTOT = 0.484704646292242157E-02
 Total 4-norm (old)     CI4oldTOT = 0.484679890158721833E-02
 The ratio of these    RAT4oldnew = 0.999948925322441839
 The target is          OKNORM4   = 0.998999999999999999
 Q-uples: CRITERION2 is satisfied
 Q-uples: (i)/(i+1) ratio is greater than OKNORM4
 -------------------------------------
 For SP4 will keep    NKEEP4 = 6283
 out of total          ISEL4 = 15333
 4-uples: for NKEEP4 TNORMAL = 0.482283064280370887E-02
 at 4-uples: ALLNORMAL(4,5,6)= 0.484704646292242157E-02
 -------------------------------------
 SELECTION OF QUADRUPLE LIVE-WOOD BEGINS
 WILL INCLUDE MOST IMPORTANT SP4= 6283
 Q-selection is step = 2
 At SDT-CI level there are:
 Symmetry-reduced strings = 3845
 Q-case: OCCU=[0,0]
 Q-case: OCCU=[0,1,1]
 Q-case: OCCU=[1,1,1,1]
 -------------------------------------
 THE QUADRUPLE SP LIVE-WOOD SELECTION COMPLETED
 CI-SDTQ only
 # Q-sp NQUADRO= 15333
 # Q-sp ISEL4= 15333
 Selection is complete for NKEEP4= 6283
 Symmetry reduced strings ICOUNTS = 10128
 -------------------------------------
 *
 *
 5-tuple: quintuple excitations start here
 *
 ---
 maximum comp. SP5 MAXSP5 = 105000
 5-tuple SMALL5 = 0.200000000000000006E-12
 -------------------------------------------------
 CONVERGENCE CRITERIUM: internal   TNORM5 = 0.949999999999999956
 CONVERGENCE CRITERIUM: external  OKNORM5 = 0.930000000000000049
 -------------------------------------------------
 ---
 5-tuple selection: lines-angle
 THE ANGLE for (D*T) triangle
 SCREENING STARTS FROM: D(2)*T(1)
 TO: D(1)*T(ISTEP3+1)
 NOTE FOR 5-tuples ISTEP3 is fixed
 HERE IS USED: ISTEP3(FIXED) = 6
  STEP3 = 6.00000000000000000
  SUGGESTED ANGLE (ITfinal) = 2
 ---
 *
 *
 *
                    ********************************
                            ICYC5 = 1
                    ********************************
 5-tuple estimation starts at doubles(SP) = 133
 --------------------------------------------------
                                ICYC5 = 1
          Total (D*T) products  ITOT5 = 53466
                SP5 components INUMB5 = 32135
               Distinct SP5 are ISEL5 = 15085
                               NKEEP5 = 35000
 --------------------------------------------------
                         NOTE: ISEL5 < NKEEP5
                              NKEEP5 = 15085
                            ------------
                            CRITERION-1
                            ------------
                            ICYC5 = 1
                    out of  ISEL5 = 15085
                            ICUT5 = 7276
              will keep    NKEEP5 = 7276
      5-norm for NKEEP5   CI5norm = 0.536369156749419028E-04
        5-relative norm    RATIO5 = 0.950045834511341614
        5-relative target  TNORM5 = 0.949999999999999956
          5-deficiency     CI5def = 0.282027168016080338E-05
 RELATIVE 5-deficiency  RELDEF5 = 0.499541654886548614E-01
                            ------------
                            CRITERION-2
                            ------------
                            ICYC5 = 1
 total 5-norm (new)     CI5newTOT = 0.564571873551029065E-04
 total 5-norm (old)     CI5oldTOT = 0.000000000000000000E+00
 The ratio of old/new             = 0.000000000000000000E+00
 The target is                    = 0.930000000000000049
 *
 *
 *
                    ********************************
                            ICYC5 = 2
                    ********************************
 5-tuple estimation starts at doubles(SP) = 153
 --------------------------------------------------
                                ICYC5 = 2
          Total (D*T) products  ITOT5 = 70686
                SP5 components INUMB5 = 43255
               Distinct SP5 are ISEL5 = 18428
                               NKEEP5 = 35000
 --------------------------------------------------
                         NOTE: ISEL5 < NKEEP5
                              NKEEP5 = 18428
                            ------------
                            CRITERION-1
                            ------------
                            ICYC5 = 2
                    out of  ISEL5 = 18428
                            ICUT5 = 8006
              will keep    NKEEP5 = 8006
      5-norm for NKEEP5   CI5norm = 0.551859295631134484E-04
        5-relative norm    RATIO5 = 0.950073806127050391
        5-relative target  TNORM5 = 0.949999999999999956
          5-deficiency     CI5def = 0.290000987361014060E-05
 RELATIVE 5-deficiency  RELDEF5 = 0.499261938729472360E-01
                            ------------
                            CRITERION-2
                            ------------
                            ICYC5 = 2
 total 5-norm (new)     CI5newTOT = 0.580859394367237288E-04
 total 5-norm (old)     CI5oldTOT = 0.564571873551029065E-04
 The ratio of old/new             = 0.971959615400640797
 The target is                    = 0.930000000000000049
 CRITERION-1: keep only THESE SP5 = 8006
 CRITERION-2: treshold between last triangles OK
 5-: for NKEEP5    TNORMAL(4,5,6) = 0.487801657236682212E-02
 at 5: for ISEL5  ALLNORMAL(4,5,6)= 0.490513240235914555E-02
     
 ---------------------------------------------- 
 FINAL STEP for 5-TUPLES: Start the selection 
    INCLUDING ONLY THESE SP5 = 8006
 5-configuration selection is STEP =  2
       At SDTQ-CI level there are:
 Symmetry-reduced strings ICOUNTS = 10128
 --------------------------
 Quintuple: OCCU=[1,0,0] starts 
  Quintuple OCCU=[1,0,0] done
       5-t: total count ICOUNT5 = 84672
      total string count ICOUNT = 169333
  symmetry reduced string count = 14238
 --------------------------------------------
 Quintuple OCCU=[1,1,1,0] starts
 Quintuple OCCU=[1,1,1,0] done
         5-t: total count ICOUNT5 = 225792
               total string count = 310453
    symmetry reduced string count = 17663
 ----------------------------------------------
 Quintuple OCCU=[1,1,1,1,1] starts
 Quintuple OCCU=[1,1,1,1,1] done
 Quintuple 5-excitations done
        5-t: total count ICOUNT5 = 254016
              total string count = 338677
   symmetry reduced string count = 18134
                    SDTQ5-CI done
 ------------------------------------------------
 -
 6-excitations: 
 -
 -
         maximum SP6-components = 105000
                 6-tuple SMALL6 = 0.499999999999999990E-12
 -
 ----------------------------------------------
 CRITERION-1:        TNORM6 = 0.989999999999999991
 CRITERION-2:       OKNORM6 = 0.949999999999999956
 ----------------------------------------------
               6-tuple selection starts here
 *
 *
 *
                           ***************
                           ICYC6 = 1
                           ***************
 6-t: estimation starts at Doubles = 133
 -------------------------------------------------
 6-tuple selection completed
          Total (D*D*D) products  ITOT6 = 69092
  number of SP6 components       INUMB6 = 23562
         Distinct SP6             ISEL6 = 14131
                                 NKEEP6 = 35000
 -------------------------------------------------
    NOTE ISEL6 < NKEEP6: WILL SET NKEEP6=ISEL6
                                 NKEEP6 = 14131
 NEW ordered set for 6-tuples:
                        ----------------
                          CRITERION-1
                        ----------------
                          ICYC6 =  1
  Number of SP6:          ISEL6 = 14131
                          ICUT6 = 10699
  will keep              NKEEP6 = 10699
 The ratio (internal)    RATIO6 = 0.990006503582941844
 The target is           TNORM6 = 0.989999999999999991
 total 6-norm in NKEEP6 CI6norm = 0.194480951707677531E-03
 6-deficiency            CI6def = 0.196316356210161840E-05
 RELATIVE 6-deficiency  RELDEF6 = 0.999349641706289218E-02
                        ----------------
                          CRITERION-2
                        ----------------
                          ICYC6 =  1
 Actual ratio old/new           = 0.000000000000000000E+00
 The target  is                 = 0.949999999999999956
 Total Norm-6 (new)   CI6newTOT = 0.196444115269778225E-03
 Total Norm-6 (old)   CI6oldTOT = 0.000000000000000000E+00
 *
 *
 *
                           ***************
                           ICYC6 = 2
                           ***************
 6-t: estimation starts at Doubles = 150
 -------------------------------------------------
 6-tuple selection completed
          Total (D*D*D) products  ITOT6 = 98500
  number of SP6 components       INUMB6 = 33764
         Distinct SP6             ISEL6 = 19261
                                 NKEEP6 = 35000
 -------------------------------------------------
    NOTE ISEL6 < NKEEP6: WILL SET NKEEP6=ISEL6
                                 NKEEP6 = 19261
 NEW ordered set for 6-tuples:
                        ----------------
                          CRITERION-1
                        ----------------
                          ICYC6 =  2
  Number of SP6:          ISEL6 = 19261
                          ICUT6 = 13473
  will keep              NKEEP6 = 13473
 The ratio (internal)    RATIO6 = 0.990017826811828594
 The target is           TNORM6 = 0.989999999999999991
 total 6-norm in NKEEP6 CI6norm = 0.201341134796041742E-03
 6-deficiency            CI6def = 0.203008675501330876E-05
 RELATIVE 6-deficiency  RELDEF6 = 0.998217318817488410E-02
                        ----------------
                          CRITERION-2
                        ----------------
                          ICYC6 =  2
 Actual ratio old/new           = 0.965938611036285977
 The target  is                 = 0.949999999999999956
 Total Norm-6 (new)   CI6newTOT = 0.203371221551054346E-03
 Total Norm-6 (old)   CI6oldTOT = 0.196444115269778225E-03
 6-tuples CRITERION-2 is satisfied
 --------------------------------------------
 CRITERION-1: keep only SPs NKEEP6 = 13473
 SELECTED NORM-SUM: TNORMAL(4,5,6) = 0.507935770716286348E-02
 TOTAL NORM-SUM    ALLNORMAL(4,5,6)= 0.510850362391019990E-02
 --------------------------------------------
    RELATIVE-DEFICIENCY(4,5,6)     = 0.570537262828195273E-02
 --------------------------------------------
        At SDTQ5-CI level there are:
 Symmetry-reduced strings ICOUNTS = 18134
 --------------------------------------------
 6-tuple SP selection is STEP = 3
 Sixtuple OCCU=[0,0,0] starts
 Sixtuple OCCU=[0,0,0] done
 Sixtuple OCCU[1,1,0,0] starts
 Sixtuple OCCU[1,1,0,0] done
 Sixtuple OCCU[1,1,1,1,0] starts
 Sixtuple OCCU[1,1,1,1,0] done
 Sixtuple OCCU[1,1,1,1,1,1] starts
 Sixtuple OCCU[1,1,1,1,1,1] done
 -------------------------
 Sixtuple-excitations  done
 CI-SDTQ56 GCI selection  done
 ------------------------------------
  total strings = 953333
  symmetry reduced strings = 31607
 ------------------------------------
                  FINAL RESULT: 
 --------------------------------------------
 SELECTED NORM-SUM: TNORMAL(4,5,6) = 0.507935770716286348E-02
 TOTAL NORM-SUM:  ALLNORMAL(4,5,6) = 0.510850362391019990E-02
 --------------------------------------------
     RELATIVE-DEFICIENCY(4,5,6)    = 0.570537262828195273E-02
 --------------------------------------------
 *
 *
  *****************************************
  TOTAL SUMMARY (COMPACT CI-SDTQ56) FOR GCI
  *****************************************
 *
 --------------------------------------------
 RELATIVE-DEFICIENCY(4,5,6) = 0.570537262828195273E-02
 --------------------------------------------
 *
 Triples SP3 kept    NKEEP3 = 3420
 out of               ISEL3 = 3420
 *
 Quadruple SP4 kept  NKEEP4 = 6283
 out of               ISEL4 = 15333
 *
 Pentuple SP5 kept   NKEEP5 = 8006
 out of               ISEL5 = 18428
 *
 Sextuple SP6 kept   NKEEP6 = 13473
 out of               ISEL6 = 19261
 --------------------------------------------
 all space-products ICOUNT= 953333
 symmetry-modified ICOUNTS= 31607
 --------------------------------------------
